<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Book List & Reservation</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; }
        h1, h2 { color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-top: 25px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .error { color: red; margin-bottom: 15px; padding: 10px; border: 1px dashed red; }
        button, .link-button { padding: 8px 12px; border: 1px solid #333; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; margin-right: 5px; }
        .reservation-form input, .reservation-form select { margin-bottom: 10px; padding: 6px; border: 1px solid #ccc; border-radius: 3px; }
        /* Додадовме стил за delete копчето да изгледа убаво иако е линк */
        .delete-btn { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }
    </style>
</head>
<body>
<h1>Book Inventory</h1>

<div th:if="${hasError}" class="error">
    <p th:text="${error}">Error Message Placeholder</p>
</div>

<a th:href="@{/books/add-form}" class="link-button" style="background-color: #d1e7dd;">+ Add New Book</a>

<h2>Current Book List</h2>
<table>
    <thead>
    <tr>
        <th>Title</th>
        <th>Genre</th>
        <th>Rating</th>
        <th>Author</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="book : ${books}">
        <td th:text="${book.title}"></td>
        <td th:text="${book.genre}"></td>
        <td th:text="${book.averageRating}"></td>
        <td th:text="${book.author != null ? book.author.name + ' ' + book.author.surname : 'Unknown author'}"></td>
        <td>
            <a th:href="@{'/books/edit-form/' + ${book.id}}" class="link-button">Edit</a>

            <a th:href="@{'/books/delete/' + ${book.id}}" class="link-button delete-btn">Delete</a>
        </td>
    </tr>
    </tbody>
</table>

<hr>

<h2>Filter Books</h2>
<form th:action="@{/books}" method="GET">
    <label>Title Text:</label>
    <input type="text" name="searchText" placeholder="Search by title" />

    <label>Minimum Rating:</label>
    <input type="number" name="searchRating" step="0.1" min="0" value="0.0" style="width: 80px;" />

    <button type="submit">Filter</button>
    <a th:href="@{/books}" class="link-button">Reset Filter</a>
</form>

<hr>

<div class="reservation-form">
    <h2>Book Reservation</h2>
    <form th:action="@{/bookReservation}" method="POST">
        <h3>Choose a book to reserve:</h3>

        <div th:each="book : ${books}" style="margin-bottom: 8px;">
            <input type="radio" name="bookTitle" th:id="'book-radio-' + ${book.id}" th:value="${book.title}" required/>
            <label th:for="'book-radio-' + ${book.id}">
                <span th:text="${'Title: ' + book.title + ', Genre: ' + book.genre + ', Author: ' + (book.author != null ? book.author.surname : 'Unknown')}"></span>
            </label>
        </div>

        <br/>

        <h3>Enter your information:</h3>
        <label>Your Name:</label>
        <input type="text" name="readerName" required><br/>

        <label>Your Address:</label>
        <input type="text" name="readerAddress" required><br/>

        <h3>Choose number of copies:</h3>
        <input type="number" name="numberOfCopies" min="1" max="10" required style="width: 100px;"><br/>

        <br/>
        <button type="submit" style="background-color: #cce5ff;">Reserve Book</button>
    </form>
</div>

</body>
</html>